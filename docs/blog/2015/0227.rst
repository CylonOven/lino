=========================
Friday, February 27, 2015
=========================

Plugin dependence
=================

The :attr:`needs_plugins <lino.core.plugin.Plugin.needs_plugins>`
attribute is relatively new, and many dependencies are not yet managed
automatically just because I did not yet take the time to declare
them.  Now I started to make more consistent usage of this attribute
by declaring ot for two plugins:

- :mod:`lino.modlib.contacts`  needs :mod:`lino.modlib.countries`
- :mod:`lino.modlib.cal` needs :mod:`lino.modlib.contenttypes`

This required a little optimization: in :class:`lino.core.site.Site`,
the :meth:`load_plugins <lino.core.site.Site.load_plugins>` method now
has a more natural behaviour: when a plugin requested by
meth:`get_installed_apps <lino.core.site.Site.get_installed_apps>`
needs some other plugin, then this other plugin is inserted into the
resulting :setting:`INSTALLED_APPS` *before* the plugin who needs
it. Until now these automatically installed plugins went to the end of
the list. Which was disturbing when using the above dependencies
because the demo fixtures need to get loaded in the right order.


Miscellaneous
=============

I discovered that :class:`lino_welfare.modlib.debts.models.Budget` has
no CharField at all. which resulted in a strange behaviour: the quick
search did not work. Now I added an explicit
:attr:`quick_search_fields
<lino.core.model.Model.quick_search_fields>` so that they can now
search by partner name at least::

    quick_search_fields = ['partner__name']

