:state: todo
:module: lino_welfare

#93 : Sozialsekretariat
=======================


todo
-----

- `isip.Contract`, `debts.Budet` and `notes.Note` must be
  *attestables*, not simply `CachedPrintable`.

  In order to avoid manual changes in the two templates used to print
  `isip.Contract` and `jobs.Contract`, we can override their
  `get_printable_context` method.

  And I must change the current template naming strategy.  The
  `lino_welfare/config/attestations/Attestation` directory is okay for
  general templates like `base.body.html` and `default.body.html`,
  `certificate.body.html`, but e.g. `cal_Guest.body.html` should be
  `cal/Guest/presence_cert.body.html`


- Ein paar konkrete Beispiele von Bescheinigungen fertig ausarbeiten.

- Familienbeziehungen aus TIM importieren.

- Datenmigration: es gibt noch Kontonummern im alten nationalen
  Format. Lino kann bisher nicht automatisch die BIC aus der NBAN
  ermitteln. Dazu wäre eine Tabelle wie die BIC.DBF in TIM nötig, die
  ein Mapping BE 731 --> BECRCEBB ermöglicht. Lohnt sich das? Ist das
  nötig?


to test
-------


- Dublettenkontrolle : wenn ein (angeblich) neuer Kunde kommt, soll
  man einfach die eid-Karte lesen. Im Normalfall haben wir die
  NR-Nummer, also gibt es keinen Zweifel.  Im Zweifelsfall legt Lino
  einen Klienten (im Status "Neuantrag") an.  Bevor man einen
  Neuantrag zuweist, kann man jetzt die neue Tabelle "Ähnliche
  Personen" (SimilarPersons) konsultieren, um eventuelle Dubletten zu
  erkennen.

- "Familienbeziehungen" heißen jetzt "Personen zu Lasten"

- Bankkonten sind momentan nur pro Klient. 
  Wollen wir das auch z.B. für Lieferanten?

- Kontonummern erfassen. N.B. In TIM haben wir auch eine Tabelle von
  belgischen BICs. Macht es Sinn, das in Lino auch so zu machen? Ist
  es nicht sowieso bald Vergangenheit, von der IBAN aus die BICzu
  errechnen? Oder einen Online-Service nutzen?

- fixed: Wenn man als Rolf in "Termin machen mit" (CoachingsByClient)
  auf den Kalender klickt ("Termin finden") und dann im Kalender für
  Hubert einen Termin mit Robin Dubois macht, dann wird der Termin
  erstellt, später verschwindet er wieder.

- Badges. in Charleroi haben sie die sogenannten "tests de
  niveau". Das sind kleine Prüfungen, die vom ÖSHZ organisiert werden,
  und die eine Fähigkeit bestätigen. Zum Beispiel "Anstreichen",
  "Nähen", "Französisch Stufe 1". Die Sozis halten in Lino fest,
  welcher Kunde wann welchen test de niveau bestanden hat.  Frage:
  Will Eupen das auch? Und wie sollen wir es nennen?

- Wer darf auf den Button "zur Hauptadresse machen" klicken?

- Brauchen wir wirklich die besprochene Tabelle der EiEi-Beträge
  (Kategorie, Seit wann, Betrag) ?

- AMK-Bescheinigungen

- Welche Angaben aus PXS fehlen noch im Detail-Fenster 
  von Empfang-->Klienten? (mit Monika klären)

    - `Krankenkasse` und `Vollmacht` : Leute, bei denen
      Medikamentenkosten vorgestreckt wurden, müssen eine Vollmacht
      unterschreiben, damit das ÖSHZ sein Geld bei der Krankenkasse
      zurückfordern kann.
 
    - Medizinische Hilfe (Art (Hausarzt / Spezialist), (x) dringend, 
      Eigentlich sind diese Felder nur eine "Vorschau" der GH-Historik.
      Können raus.
     
    - Generika, Mietgarantie, MAF, Referenzadresse:
      werden scheinbar nicht mehr benutzt.

    - Sozialhilfekonto

    - Wann ist die letzte Bescheinigung "Lebensmittelbank" (oder
      "Kleiderkammer") rausgegangen?  Manche Bescheinigungsarten
      dürfen frühestens nach 6 Monaten verlängert werden.

    - Bemerkungen, Notizen (freies Textfeld. wichtig.)

- Kann ein Klient eigentlich auf zwei Agenten zugleich warten? 
  Soll Lino das verhindern? 

- Konfigurierbare Historik:
  Historik als virtuelle Tabelle, die ihre "Chronik-Einträge" aus
  diversen Quellen zusammensucht:
  history.HistoricEvents.add(name,model,field)

  Rückfragen: Bitte genauer definieren, welchen Zweck diese Tabelle
  erfüllen soll.  Ich habe notiert "Wann war ein Klient das letzte Mal
  da? Was ist alles passiert?", aber das reicht mir nicht. Bitte ein
  konkretes Beispiel beschreiben. 
      
    

Done
-------

- Mehrere Adressen pro Klient : 
   - Adressart (Referenzadresse, Reelle, Offizieller Wohnsitz, Sonstige)
   - Button "zur Hauptadresse machen" (wer darf drauf klicken?)

- eid-Karte einlesen : funktioniert momentan mit :ref:`eidreader`.
  Die Idee, dass wir :ref:`davlink` und :ref:`eidreader` als Browser
  extension implementieren müssen, erwies sich als unnötig.

- Bescheinigungen können jetzt mit einem Klick rauskommen. 
  (wenn beide Felder skip_dialog und primary angekreuzt sind)

- Uhrzeiten "von" und "bis" einer visite (prompt calendar event) wird
  jetzt automatisch ausgefüllt :

    - Beginn = bei Empfang des ersten Gastes (receive)
    - Ende = wenn der (erste) Gast geht (checkout)

- Bankkontonummern pro Klient in separater Tabelle.  Mit Kontenart
  (Sichtkonto, Sparkonto, Budgetbegleitung, Sozialhilfekonto, ...)



Pages referring to this
-----------------------

.. refstothis::
